<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="css/jquery-ui-1.9.1.custom.min.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <script type="text/javascript" src="libs/d3.v2.js"></script>
    <script type="text/javascript" src="libs/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="libs/jquery-ui-1.9.1.custom.min.js"></script>
    <script type="text/javascript" src="pool/sampledata.js"></script>
    <script type="text/javascript" src="pool/Pool.js"></script>
    <script type="text/javascript" src="pool/Generators.js"></script>
    <script type="text/javascript" src="brain.js"></script>
    <script type="text/javascript">
      function value_form_select(select_id) {
        return $('#'+select_id).find(":selected").attr("value");
      }

      function process_request() {
        dp_id = value_form_select("structure_picker")
        act_id = value_form_select("action_picker")
        $("#grot").html("")

        st_info = {}
        if (value_form_select("structure_picker") == "Rem+" || value_form_select("structure_picker") == "Rem*") {
          rem_base = parseInt($("#base").attr("value"), 10)
          st_info = {"id":dp_id, 'args':[rem_base]}
        } else if (value_form_select("structure_picker") == "Raw") {
          st_info = {"id":dp_id, 'args':[$("#raw_data").attr("value")]}
        }

        if (act_id == "mult") {
          el1 = parseInt($("#el1").attr("value"), 10)
          el2 = parseInt($("#el2").attr("value"), 10)

          process_data(act_id, st_info, el1, el2)
        } else if (act_id == "show_structure") {
          rem_base = parseInt($("#base").attr("value"), 10)
          process_data(act_id, st_info)
        } else if (act_id == "show_coset") {
          //TODO fix this HACK!
          selected_nodes = vis_pool["STR_SHOW"].get_selected_nodes();
          process_data(act_id, st_info, selected_nodes)
        }
      }

      function structure_changed() {
        var aux_attr = $("#aux_str_attrs")
        var aux_html = ""

        if (value_form_select("structure_picker") == "Rem+" || value_form_select("structure_picker") == "Rem*") {
          aux_html = "Set modulo <input id='base' type='text'></input>"
        } else if (value_form_select("structure_picker") == "Raw") {
          aux_html = "Raw data:<textarea cols=45 rows=10 id='raw_data'>"+
            "{\n  name:'sample',\n  elements:['a','b','c'],\n  neutral:'e',\n"+
            "  operation:\n   [['a','b','c'],\n    ['b','c','a'],\n    ['c','a','b']]\n}"+
            "</textarea>"
        }
        aux_attr.html(aux_html)
      }

      function action_changed() {
        var aux_attr = $("#aux_action_attrs")
        var aux_html = ""
        if (value_form_select("action_picker") == "mult") {
          aux_html = "Set el1 <input id='el1' type='text'><br/></input> Set el2 <input id='el2' type='text'></input>"
        } 

        aux_attr.html(aux_html)
      }

    </script>
  
  </head>

  <body>
    <div id="controls_pane" class="ui-corner-all ui-widget-content" >
      Structure: 
      <select id="structure_picker" onchange="structure_changed()">
        <option value="TBD" selected="selected" >TBD</option>
        <option value="Rem+" >Group Rem+</option>
        <option value="Rem*" >Group Rem*</option>
        <option value="Raw" >Enter manually</option>
      </select>
      <div id="aux_str_attrs" ></div>

      Action:
      <select id="action_picker" onchange="action_changed()">
        <option value="TBD" selected="selected" >TBD</option>
        <option value="mult" >Perform Operation With Elements</option>
        <option value="show_structure" >Show Cayley Table</option>
        <option value="show_coset" >Show Left Coset</option>
      </select>
      <div id="aux_action_attrs" ></div>

      <button onclick="process_request();">Exec</button>
    </div>

    <div id="grot" ></div>
  </body>
</html>